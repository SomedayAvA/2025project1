#include "FrenetUtils.h"
#include <limits>
#include <cmath>

namespace veins {
double distance(const Coord& a, const Coord& b) {
    return std::sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));
}
static std::vector<Coord> buildReferenceLine() {
    std::vector<Coord> refLine;
    refLine.push_back({252.537, 394.488});
    refLine.push_back({209.193, 415.188});
    refLine.push_back({204.261, 417.543});
    refLine.push_back({198.766, 420.168});
    refLine.push_back({195.780, 421.347});
    refLine.push_back({193.948, 421.100});
    refLine.push_back({193.901, 421.058});
    refLine.push_back({193.807, 420.973});
    refLine.push_back({193.432, 420.635});
    refLine.push_back({193.197, 420.424});
    refLine.push_back({192.962, 420.212});
    refLine.push_back({192.677, 419.882});
    refLine.push_back({192.491, 419.551});
    refLine.push_back({191.651, 418.003});
    refLine.push_back({189.670, 413.329});
    refLine.push_back({27.560, 31.586});
    refLine.push_back({-50, -151.055});
    refLine.push_back({-5000, -11797.50});
    return refLine;
}
static std::vector<Coord> buildReferenceLine1() {
    std::vector<Coord> refLine;
    refLine.push_back({224.667,695.534});
    refLine.push_back({224.657,695.582});
    refLine.push_back({224.642,695.654});
    refLine.push_back({224.642,695.654});
    refLine.push_back({224.623,695.75});
    refLine.push_back({224.599,695.87});
    refLine.push_back({224.57,696.015});
    refLine.push_back({224.499,696.368});
    refLine.push_back({224.499,696.368});
    refLine.push_back({224.457,696.575});
    refLine.push_back({224.363,697.039});
    refLine.push_back({224.309,697.306});
    refLine.push_back({224.251,697.594});
    refLine.push_back({224.19,697.897});
    refLine.push_back({224.125,698.221});
    refLine.push_back({224.056,698.562});
    refLine.push_back({223.982,698.927});
    refLine.push_back({223.904,699.315});
    refLine.push_back({223.821,699.725});
    refLine.push_back({223.736,700.15});
    refLine.push_back({223.647,700.588});
    refLine.push_back({223.554,701.052});
    refLine.push_back({223.456,701.537});
    refLine.push_back({223.354,702.042});
    refLine.push_back({223.313,702.565});
    refLine.push_back({223.375,703.112});
    refLine.push_back({223.438,703.673});
    refLine.push_back({223.503,704.248});
    refLine.push_back({223.57,704.838});
    refLine.push_back({223.639,705.448});
    refLine.push_back({223.711,706.082});
    refLine.push_back({223.784,706.73});
    refLine.push_back({223.86,707.402});
    refLine.push_back({223.938,708.091});
    refLine.push_back({224.018,708.805});
    refLine.push_back({224.101,709.535});
    refLine.push_back({224.186,710.291});
    refLine.push_back({224.274,711.07});
    refLine.push_back({224.365,711.873});
    refLine.push_back({224.458,712.697});
    refLine.push_back({224.553,713.534});
    refLine.push_back({224.649,714.386});
    refLine.push_back({224.748,715.259});
    refLine.push_back({224.849,716.155});
    refLine.push_back({224.952,717.067});
    refLine.push_back({225.058,718.003});
    refLine.push_back({225.21,718.953});
    refLine.push_back({225.384,719.913});
    refLine.push_back({225.561,720.892});
    refLine.push_back({225.742,721.893});
    refLine.push_back({225.926,722.908});
    refLine.push_back({226.114,723.945});
    refLine.push_back({226.306,725.007});
    refLine.push_back({226.502,726.088});
    refLine.push_back({226.701,727.188});
    refLine.push_back({226.904,728.31});
    refLine.push_back({227.112,729.456});
    refLine.push_back({227.323,730.622});
    refLine.push_back({227.538,731.807});
    refLine.push_back({227.755,733.008});
    refLine.push_back({227.975,734.225});
    refLine.push_back({228.196,735.441});
    refLine.push_back({228.415,736.654});
    refLine.push_back({228.635,737.867});
    refLine.push_back({228.854,739.079});
    refLine.push_back({229.073,740.289});
    refLine.push_back({229.294,741.505});
    refLine.push_back({229.513,742.714});
    refLine.push_back({229.732,743.927});
    refLine.push_back({229.952,745.139});
    refLine.push_back({230.591,746.184});
    refLine.push_back({231.266,747.211});
    refLine.push_back({231.945,748.243});
    refLine.push_back({232.621,749.271});
    refLine.push_back({233.3,750.303});
    refLine.push_back({233.979,751.336});
    refLine.push_back({234.658,752.368});
    refLine.push_back({235.338,753.403});
    refLine.push_back({236.017,754.435});
    refLine.push_back({236.692,755.462});
    refLine.push_back({237.373,756.497});
    refLine.push_back({238.05,757.526});
    refLine.push_back({238.731,758.562});
    refLine.push_back({239.407,759.59});
    refLine.push_back({240.088,760.625});
    refLine.push_back({240.765,761.655});
    refLine.push_back({241.442,762.684});
    refLine.push_back({242.122,763.718});
    refLine.push_back({242.803,764.754});
    refLine.push_back({243.481,765.785});
    refLine.push_back({244.159,766.816});
    refLine.push_back({244.835,767.844});
    refLine.push_back({245.516,768.879});
    refLine.push_back({246.192,769.907});
    refLine.push_back({246.873,770.943});
    refLine.push_back({247.553,771.976});
    refLine.push_back({248.23,773.005});
    refLine.push_back({248.91,774.04});
    refLine.push_back({249.588,775.071});
    refLine.push_back({250.269,776.107});
    refLine.push_back({250.944,777.133});
    refLine.push_back({251.623,778.165});
    refLine.push_back({252.302,779.198});
    refLine.push_back({252.982,780.232});
    refLine.push_back({253.662,781.266});
    refLine.push_back({254.338,782.294});
    refLine.push_back({255.015,783.323});
    refLine.push_back({255.693,784.354});
    refLine.push_back({256.372,785.386});
    refLine.push_back({257.046,786.412});
    refLine.push_back({257.722,787.44});
    refLine.push_back({258.401,788.473});
    refLine.push_back({259.128,789.464});
    refLine.push_back({259.883,790.447});
    refLine.push_back({260.635,791.426});
    refLine.push_back({261.384,792.4});
    refLine.push_back({262.137,793.381});
    refLine.push_back({262.887,794.356});
    refLine.push_back({263.642,795.339});
    refLine.push_back({264.396,796.32});
    refLine.push_back({265.149,797.3});
    refLine.push_back({265.902,798.28});
    refLine.push_back({266.657,799.262});
    refLine.push_back({267.407,800.239});
    refLine.push_back({268.157,801.215});
    refLine.push_back({268.909,802.193});
    refLine.push_back({269.661,803.172});
    refLine.push_back({270.409,804.146});
    refLine.push_back({271.161,805.124});
    refLine.push_back({271.914,806.105});
    refLine.push_back({272.664,807.081});
    refLine.push_back({273.415,808.058});
    refLine.push_back({274.167,809.037});
    refLine.push_back({274.922,810.019});
    refLine.push_back({275.673,810.996});
    refLine.push_back({276.423,811.973});
    refLine.push_back({277.172,812.948});
    refLine.push_back({277.923,813.926});
    refLine.push_back({278.676,814.904});
    refLine.push_back({279.429,815.885});
    refLine.push_back({280.177,816.859});
    refLine.push_back({280.929,817.837});
    refLine.push_back({281.683,818.819});
    refLine.push_back({282.438,819.801});
    refLine.push_back({283.193,820.784});
    refLine.push_back({283.944,821.761});
    refLine.push_back({283.944,821.761});
    refLine.push_back({285.449,823.72});
    refLine.push_back({286.197,824.694});
    refLine.push_back({286.945,825.667});
    refLine.push_back({287.696,826.644});
    refLine.push_back({288.444,827.617});
    refLine.push_back({289.197,828.598});
    refLine.push_back({289.95,829.578});
    refLine.push_back({290.702,830.556});
    refLine.push_back({291.452,831.533});
    refLine.push_back({292.201,832.507});
    refLine.push_back({292.951,833.483});
    refLine.push_back({293.7,834.458});
    refLine.push_back({294.453,835.439});
    refLine.push_back({295.208,836.421});
    refLine.push_back({295.963,837.403});
    refLine.push_back({296.716,838.383});
    refLine.push_back({297.471,839.366});
    refLine.push_back({298.224,840.347});
    refLine.push_back({298.973,841.32});
    refLine.push_back({299.724,842.298});
    refLine.push_back({300.478,843.28});
    refLine.push_back({301.228,844.256});
    refLine.push_back({301.979,845.233});
    refLine.push_back({302.732,846.213});
    refLine.push_back({303.484,847.192});
    refLine.push_back({304.235,848.17});
    refLine.push_back({304.986,849.146});
    refLine.push_back({305.737,850.124});
    refLine.push_back({306.491,851.105});
    refLine.push_back({307.24,852.078});
    refLine.push_back({307.993,853.056});
    refLine.push_back({308.748,854.036});
    refLine.push_back({309.446,855.055});
    refLine.push_back({309.995,856.167});
    refLine.push_back({310.54,857.272});
    refLine.push_back({311.089,858.383});
    refLine.push_back({311.634,859.487});
    refLine.push_back({312.18,860.594});
    refLine.push_back({312.724,861.695});
    refLine.push_back({313.27,862.801});
    refLine.push_back({313.819,863.912});
    refLine.push_back({314.364,865.017});
    refLine.push_back({314.909,866.12});
    refLine.push_back({315.453,867.222});
    refLine.push_back({316.001,868.333});
    refLine.push_back({316.549,869.443});
    refLine.push_back({317.093,870.545});
    refLine.push_back({317.639,871.652});
    refLine.push_back({318.187,872.762});
    refLine.push_back({318.73,873.863});
    refLine.push_back({319.274,874.965});
    refLine.push_back({319.821,876.073});
    refLine.push_back({320.367,877.179});
    refLine.push_back({320.915,878.291});
    refLine.push_back({321.187,879.49});
    refLine.push_back({321.456,880.689});
    refLine.push_back({321.725,881.891});
    refLine.push_back({321.995,883.094});
    refLine.push_back({322.265,884.301});
    refLine.push_back({322.534,885.499});
    refLine.push_back({322.804,886.704});
    refLine.push_back({323.073,887.906});
    refLine.push_back({323.342,889.105});
    refLine.push_back({323.611,890.303});
    refLine.push_back({323.88,891.505});
    refLine.push_back({324.149,892.707});
    refLine.push_back({324.419,893.909});
    refLine.push_back({324.69,895.117});
    refLine.push_back({324.959,896.318});
    refLine.push_back({325.228,897.52});
    refLine.push_back({325.499,898.729});
    refLine.push_back({325.769,899.932});
    refLine.push_back({326.04,901.134});
    refLine.push_back({326.312,902.344});
    refLine.push_back({326.58,903.546});
    refLine.push_back({326.618,904.776});
    refLine.push_back({326.655,906.011});
    refLine.push_back({326.692,907.249});
    refLine.push_back({326.73,908.487});
    refLine.push_back({326.767,909.72});
    refLine.push_back({326.804,910.955});
    refLine.push_back({326.841,912.186});
    refLine.push_back({326.879,913.426});
    refLine.push_back({326.916,914.656});
    refLine.push_back({326.953,915.892});
    refLine.push_back({326.99,917.12});
    refLine.push_back({327.027,918.35});
    refLine.push_back({327.065,919.588});
    refLine.push_back({327.102,920.826});
    refLine.push_back({327.139,922.063});
    refLine.push_back({327.177,923.291});
    refLine.push_back({327.214,924.526});
    refLine.push_back({327.251,925.755});
    refLine.push_back({327.288,926.989});
    refLine.push_back({327.325,928.22});
    refLine.push_back({327.363,929.452});
    refLine.push_back({327.4,930.684});
    refLine.push_back({327.437,931.911});
    refLine.push_back({327.465,933.15});
    refLine.push_back({327.42,934.382});
    refLine.push_back({327.375,935.613});
    refLine.push_back({327.33,936.843});
    refLine.push_back({327.285,938.071});
    refLine.push_back({327.24,939.309});
    refLine.push_back({327.195,940.546});
    refLine.push_back({327.15,941.779});
    refLine.push_back({327.105,943.01});
    refLine.push_back({327.06,944.248});
    refLine.push_back({327.015,945.479});
    refLine.push_back({326.97,946.716});
    refLine.push_back({326.925,947.945});
    refLine.push_back({326.88,949.173});
    refLine.push_back({326.835,950.399});
    refLine.push_back({326.79,951.634});
    refLine.push_back({326.745,952.873});
    refLine.push_back({326.699,954.109});
    refLine.push_back({326.55,955.334});
    refLine.push_back({326.402,956.555});
    refLine.push_back({326.254,957.777});
    refLine.push_back({326.106,959.002});
    refLine.push_back({325.957,960.229});
    refLine.push_back({325.809,961.451});
    refLine.push_back({325.66,962.68});
    refLine.push_back({325.511,963.906});
    refLine.push_back({325.362,965.136});
    refLine.push_back({325.362,965.136});
    refLine.push_back({325.214,966.358});
    refLine.push_back({325.065,967.589});
    refLine.push_back({324.916,968.815});
    refLine.push_back({324.768,970.039});
    refLine.push_back({324.62,971.264});
    refLine.push_back({324.471,972.486});
    refLine.push_back({324.323,973.71});
    refLine.push_back({324.175,974.929});
    refLine.push_back({324.026,976.159});
    refLine.push_back({323.873,977.389});
    refLine.push_back({323.699,978.61});
    refLine.push_back({323.525,979.83});
    refLine.push_back({323.351,981.048});
    refLine.push_back({323.178,982.265});
    refLine.push_back({323.004,983.485});
    refLine.push_back({322.831,984.701});
    refLine.push_back({322.657,985.922});
    refLine.push_back({322.483,987.139});
    refLine.push_back({322.309,988.361});
    refLine.push_back({322.135,989.58});
    refLine.push_back({321.961,990.8});
    refLine.push_back({321.781,992.022});
    refLine.push_back({321.576,993.238});
    refLine.push_back({321.306,994.434});
    refLine.push_back({320.962,995.616});
    refLine.push_back({320.617,996.798});
    refLine.push_back({320.274,997.978});
    refLine.push_back({319.928,999.165});
    refLine.push_back({319.582,1000.36});
    refLine.push_back({319.236,1001.54});
    refLine.push_back({318.89,1002.73});
    refLine.push_back({318.544,1003.92});
    refLine.push_back({318.201,1005.1});
    refLine.push_back({317.855,1006.29});
    refLine.push_back({317.51,1007.47});
    refLine.push_back({317.164,1008.66});
    refLine.push_back({316.819,1009.85});
    refLine.push_back({316.473,1011.03});
    refLine.push_back({316.128,1012.22});
    refLine.push_back({315.784,1013.4});
    refLine.push_back({315.438,1014.59});
    refLine.push_back({315.093,1015.77});
    refLine.push_back({314.75,1016.95});
    refLine.push_back({314.405,1018.14});
    refLine.push_back({314.059,1019.32});
    refLine.push_back({313.713,1020.51});
    refLine.push_back({313.369,1021.69});
    refLine.push_back({313.025,1022.87});
    refLine.push_back({312.679,1024.06});
    refLine.push_back({312.332,1025.25});
    refLine.push_back({311.988,1026.44});
    refLine.push_back({311.642,1027.62});
    refLine.push_back({310.951,1030});
    refLine.push_back({310.951,1030});
    refLine.push_back({310.295,1032.38});
    refLine.push_back({309.973,1033.56});
    refLine.push_back({309.973,1033.56});
    refLine.push_back({309.33,1035.94});
    refLine.push_back({309.33,1035.94});
    refLine.push_back({309.007,1037.13});
    refLine.push_back({308.686,1038.32});
    refLine.push_back({308.365,1039.51});
    refLine.push_back({308.043,1040.7});
    refLine.push_back({307.399,1043.08});
    refLine.push_back({307.076,1044.27});
    refLine.push_back({306.77,1045.46});
    refLine.push_back({306.473,1046.65});
    refLine.push_back({306.174,1047.85});
    refLine.push_back({305.875,1049.05});
    refLine.push_back({305.577,1050.24});
    refLine.push_back({305.279,1051.43});
    refLine.push_back({304.982,1052.63});
    refLine.push_back({304.685,1053.82});
    refLine.push_back({304.385,1055.02});
    refLine.push_back({304.088,1056.21});
    refLine.push_back({304.088,1056.21});
    refLine.push_back({303.79,1057.4});
    refLine.push_back({303.491,1058.6});
    refLine.push_back({303.193,1059.79});
    refLine.push_back({302.596,1062.19});
    refLine.push_back({302.299,1063.38});
    refLine.push_back({302.299,1063.38});
    refLine.push_back({301.703,1065.77});
    refLine.push_back({301.403,1066.97});
    refLine.push_back({301.403,1066.97});
    refLine.push_back({300.806,1069.36});
    refLine.push_back({300.506,1070.56});
    refLine.push_back({300.208,1071.76});
    refLine.push_back({299.948,1072.96});
    refLine.push_back({299.766,1074.18});
    refLine.push_back({299.583,1075.41});
    refLine.push_back({299.401,1076.62});
    refLine.push_back({299.219,1077.84});
    refLine.push_back({299.036,1079.06});
    refLine.push_back({299.036,1079.06});
    refLine.push_back({298.853,1080.28});
    refLine.push_back({298.671,1081.5});
    refLine.push_back({298.306,1083.94});
    refLine.push_back({298.306,1083.94});
    refLine.push_back({298.123,1085.16});
    refLine.push_back({297.941,1086.38});
    refLine.push_back({297.758,1087.6});
    refLine.push_back({297.576,1088.82});
    refLine.push_back({297.393,1090.04});
    refLine.push_back({297.215,1091.26});
    refLine.push_back({297.052,1092.48});
    refLine.push_back({296.888,1093.71});
    refLine.push_back({296.743,1094.94});
    refLine.push_back({296.633,1096.16});
    refLine.push_back({296.523,1097.39});
    refLine.push_back({296.442,1098.62});
    refLine.push_back({296.389,1099.85});
    refLine.push_back({296.336,1101.08});
    refLine.push_back({296.332,1102.31});
    refLine.push_back({296.349,1103.55});
    refLine.push_back({296.366,1104.79});
    refLine.push_back({296.404,1106.02});
    refLine.push_back({296.448,1107.25});
    refLine.push_back({296.493,1108.49});
    refLine.push_back({296.537,1109.72});
    refLine.push_back({296.581,1110.95});
    refLine.push_back({296.626,1112.18});
    refLine.push_back({296.67,1113.42});
    refLine.push_back({296.714,1114.65});
    refLine.push_back({296.759,1115.88});
    refLine.push_back({296.803,1117.12});
    refLine.push_back({296.847,1118.36});
    refLine.push_back({296.892,1119.58});
    refLine.push_back({296.936,1120.82});
    refLine.push_back({296.98,1122.05});
    refLine.push_back({297.069,1124.52});
    refLine.push_back({297.069,1124.52});
    refLine.push_back({297.114,1125.76});
    refLine.push_back({297.158,1126.99});
    refLine.push_back({297.202,1128.22});
    refLine.push_back({297.246,1129.46});
    refLine.push_back({297.291,1130.69});
    refLine.push_back({297.335,1131.93});
    refLine.push_back({297.38,1133.16});
    refLine.push_back({297.424,1134.39});
    refLine.push_back({297.468,1135.62});
    refLine.push_back({297.512,1136.84});
    refLine.push_back({297.556,1138.08});
    refLine.push_back({297.6,1139.31});
    refLine.push_back({297.645,1140.53});
    refLine.push_back({297.689,1141.77});
    refLine.push_back({297.734,1143.01});
    refLine.push_back({297.778,1144.24});
    refLine.push_back({297.822,1145.48});
    refLine.push_back({297.867,1146.71});
    refLine.push_back({297.911,1147.94});
    refLine.push_back({297.955,1149.17});
    refLine.push_back({297.999,1150.4});
    refLine.push_back({298.043,1151.63});
    refLine.push_back({298.088,1152.86});
    refLine.push_back({298.132,1154.1});
    refLine.push_back({298.176,1155.33});
    refLine.push_back({298.221,1156.56});
    refLine.push_back({298.265,1157.79});
    refLine.push_back({298.309,1159.03});
    refLine.push_back({298.354,1160.26});
    refLine.push_back({298.398,1161.5});
    refLine.push_back({298.442,1162.73});
    refLine.push_back({298.487,1163.96});
    refLine.push_back({298.531,1165.2});
    refLine.push_back({298.575,1166.44});
    refLine.push_back({298.62,1167.67});
    refLine.push_back({298.713,1168.89});
    refLine.push_back({298.914,1170.11});
    refLine.push_back({299.114,1171.33});
    refLine.push_back({299.316,1172.55});
    refLine.push_back({299.499,1173.66});
    refLine.push_back({299.7,1174.88});
    refLine.push_back({299.902,1176.11});
    refLine.push_back({300.103,1177.33});
    refLine.push_back({300.291,1178.55});
    refLine.push_back({300.483,1179.76});
    refLine.push_back({300.678,1180.99});
    refLine.push_back({300.871,1182.21});
    refLine.push_back({301.064,1183.43});
    refLine.push_back({301.255,1184.65});
    refLine.push_back({301.447,1185.87});
    refLine.push_back({301.639,1187.09});
    refLine.push_back({301.832,1188.31});
    refLine.push_back({302.025,1189.54});
    refLine.push_back({302.217,1190.76});
    refLine.push_back({302.41,1191.98});
    refLine.push_back({302.603,1193.21});
    refLine.push_back({302.795,1194.43});
    refLine.push_back({302.986,1195.64});
    refLine.push_back({303.178,1196.86});
    refLine.push_back({303.371,1198.09});
    refLine.push_back({303.563,1199.31});
    refLine.push_back({303.756,1200.53});
    refLine.push_back({303.949,1201.76});
    refLine.push_back({304.141,1202.98});
    refLine.push_back({304.333,1204.2});
    refLine.push_back({304.525,1205.41});
    refLine.push_back({304.717,1206.64});
    refLine.push_back({304.91,1207.86});
    refLine.push_back({305.101,1209.07});
    refLine.push_back({305.293,1210.29});
    refLine.push_back({305.484,1211.51});
    refLine.push_back({305.675,1212.72});
    refLine.push_back({305.868,1213.95});
    refLine.push_back({306.059,1215.16});
    refLine.push_back({306.251,1216.37});
    refLine.push_back({306.442,1217.59});
    refLine.push_back({306.634,1218.81});
    refLine.push_back({306.826,1220.03});
    refLine.push_back({307.018,1221.25});
    refLine.push_back({307.21,1222.47});
    refLine.push_back({307.402,1223.68});
    refLine.push_back({307.593,1224.9});
    refLine.push_back({307.785,1226.12});
    refLine.push_back({307.976,1227.33});
    refLine.push_back({308.168,1228.55});
    refLine.push_back({308.359,1229.76});
    refLine.push_back({308.551,1230.98});
    refLine.push_back({308.743,1232.2});
    refLine.push_back({308.934,1233.42});
    refLine.push_back({309.126,1234.63});
    refLine.push_back({309.317,1235.85});
    refLine.push_back({309.509,1237.07});
    refLine.push_back({309.701,1238.28});
    refLine.push_back({309.892,1239.5});
    refLine.push_back({310.083,1240.71});
    refLine.push_back({310.275,1241.93});
    refLine.push_back({310.463,1243.15});
    refLine.push_back({310.651,1244.36});
    refLine.push_back({310.838,1245.58});
    refLine.push_back({311.027,1246.8});
    refLine.push_back({311.216,1248.02});
    refLine.push_back({311.406,1249.25});
    refLine.push_back({311.594,1250.47});
    refLine.push_back({311.783,1251.69});
    refLine.push_back({311.971,1252.91});
    refLine.push_back({312.159,1254.13});
    refLine.push_back({312.347,1255.34});
    refLine.push_back({312.536,1256.57});
    refLine.push_back({312.724,1257.78});
    refLine.push_back({312.912,1258.99});
    refLine.push_back({313.099,1260.21});
    refLine.push_back({313.286,1261.42});
    refLine.push_back({313.475,1262.64});
    refLine.push_back({313.664,1263.86});
    refLine.push_back({313.852,1265.08});
    refLine.push_back({314.041,1266.3});
    refLine.push_back({314.228,1267.52});
    refLine.push_back({314.416,1268.73});
    refLine.push_back({314.604,1269.94});
    refLine.push_back({314.793,1271.17});
    refLine.push_back({314.981,1272.39});
    refLine.push_back({315.169,1273.6});
    refLine.push_back({315.358,1274.82});
    refLine.push_back({315.547,1276.05});
    refLine.push_back({315.736,1277.27});
    refLine.push_back({315.925,1278.49});
    refLine.push_back({316.113,1279.71});
    refLine.push_back({316.302,1280.93});
    refLine.push_back({316.49,1282.15});
    refLine.push_back({316.678,1283.37});
    refLine.push_back({316.867,1284.59});
    refLine.push_back({317.056,1285.81});
    refLine.push_back({317.244,1287.03});
    refLine.push_back({317.432,1288.25});
    refLine.push_back({317.62,1289.46});
    refLine.push_back({317.807,1290.67});
    refLine.push_back({317.996,1291.9});
    refLine.push_back({318.184,1293.11});
    refLine.push_back({318.372,1294.33});
    refLine.push_back({318.56,1295.55});
    refLine.push_back({318.748,1296.76});
    refLine.push_back({318.937,1297.99});
    refLine.push_back({319.125,1299.2});
    refLine.push_back({319.313,1300.42});
    refLine.push_back({319.503,1301.65});
    refLine.push_back({319.69,1302.86});
    refLine.push_back({319.878,1304.08});
    refLine.push_back({320.068,1305.3});
    refLine.push_back({320.256,1306.52});
    refLine.push_back({320.445,1307.74});
    refLine.push_back({320.633,1308.96});
    refLine.push_back({320.822,1310.18});
    refLine.push_back({321.011,1311.41});
    refLine.push_back({321.2,1312.63});
    refLine.push_back({321.389,1313.85});
    refLine.push_back({321.577,1315.07});
    refLine.push_back({321.766,1316.29});
    refLine.push_back({321.955,1317.52});
    refLine.push_back({322.143,1318.73});
    refLine.push_back({322.332,1319.96});
    refLine.push_back({322.521,1321.18});
    refLine.push_back({322.711,1322.4});
    refLine.push_back({322.9,1323.63});
    refLine.push_back({323.089,1324.85});
    refLine.push_back({323.278,1326.07});
    refLine.push_back({323.466,1327.29});
    refLine.push_back({323.654,1328.51});
    refLine.push_back({323.842,1329.72});
    refLine.push_back({324.03,1330.94});
    refLine.push_back({324.206,1332.16});
    refLine.push_back({324.371,1333.38});
    refLine.push_back({324.538,1334.61});
    refLine.push_back({324.704,1335.84});
    refLine.push_back({324.87,1337.06});
    refLine.push_back({325.035,1338.27});
    refLine.push_back({325.201,1339.5});
    refLine.push_back({325.368,1340.72});
    refLine.push_back({325.535,1341.95});
    refLine.push_back({325.701,1343.18});
    refLine.push_back({325.866,1344.39});
    refLine.push_back({326.033,1345.62});
    refLine.push_back({326.198,1346.84});
    refLine.push_back({326.365,1348.06});
    refLine.push_back({326.532,1349.29});
    refLine.push_back({326.698,1350.51});
    refLine.push_back({326.864,1351.74});
    refLine.push_back({327.03,1352.96});
    refLine.push_back({327.196,1354.18});
    refLine.push_back({327.362,1355.41});
    refLine.push_back({327.528,1356.63});
    refLine.push_back({327.695,1357.86});
    refLine.push_back({327.861,1359.08});
    refLine.push_back({328.027,1360.31});
    refLine.push_back({328.194,1361.53});
    refLine.push_back({328.361,1362.76});
    refLine.push_back({328.526,1363.98});
    refLine.push_back({328.692,1365.2});
    refLine.push_back({328.858,1366.42});
    refLine.push_back({329.024,1367.64});
    refLine.push_back({329.19,1368.87});
    refLine.push_back({329.356,1370.09});
    refLine.push_back({329.521,1371.31});
    refLine.push_back({329.687,1372.53});
    refLine.push_back({329.854,1373.76});
    refLine.push_back({330.02,1374.98});
    refLine.push_back({330.186,1376.2});
    refLine.push_back({330.352,1377.42});
    refLine.push_back({330.518,1378.65});
    refLine.push_back({330.684,1379.87});
    refLine.push_back({330.851,1381.09});
    refLine.push_back({331.017,1382.32});
    refLine.push_back({331.184,1383.55});
    refLine.push_back({331.349,1384.76});
    refLine.push_back({331.551,1385.99});
    refLine.push_back({331.769,1387.2});
    refLine.push_back({331.987,1388.42});
    refLine.push_back({332.205,1389.64});
    refLine.push_back({332.421,1390.84});
    refLine.push_back({332.638,1392.06});
    refLine.push_back({332.855,1393.27});
    refLine.push_back({333.073,1394.48});
    refLine.push_back({333.29,1395.7});
    refLine.push_back({333.508,1396.91});
    refLine.push_back({333.725,1398.13});
    refLine.push_back({333.943,1399.34});
    refLine.push_back({334.159,1400.55});
    refLine.push_back({334.377,1401.77});
    refLine.push_back({334.595,1402.99});
    refLine.push_back({334.813,1404.2});
    refLine.push_back({335.031,1405.42});
    refLine.push_back({335.249,1406.64});
    refLine.push_back({335.466,1407.85});
    refLine.push_back({335.684,1409.07});
    refLine.push_back({335.902,1410.29});
    refLine.push_back({336.119,1411.5});
    refLine.push_back({336.336,1412.71});
    refLine.push_back({336.554,1413.93});
    refLine.push_back({336.773,1415.15});
    refLine.push_back({336.972,1416.27});
    refLine.push_back({337.188,1417.48});
    refLine.push_back({337.406,1418.7});
    refLine.push_back({337.62,1419.92});
    refLine.push_back({337.841,1421.14});
    refLine.push_back({338.062,1422.36});
    refLine.push_back({338.28,1423.57});
    refLine.push_back({338.494,1424.77});
    refLine.push_back({338.71,1425.98});
    refLine.push_back({338.925,1427.19});
    refLine.push_back({339.142,1428.4});
    return refLine;
}

Coord getCartesianFromFrenet(double s, double d) {
    std::vector<Coord> refLine = buildReferenceLine1();
    double sAccum = 0.0;
    Coord refPoint = {0.0, 0.0};
    double theta = 0.0;

    for (size_t i = 0; i < refLine.size() - 1; i++) {
        Coord A = refLine[i];
        Coord B = refLine[i+1];
        double segLen = std::hypot(B.x - A.x, B.y - A.y);

        if (sAccum + segLen >= s) {
            double t = (s - sAccum) / segLen;
            refPoint.x = A.x + t * (B.x - A.x);
            refPoint.y = A.y + t * (B.y - A.y);
            theta = std::atan2(B.y - A.y, B.x - A.x);
            break;
        }
        sAccum += segLen;
    }

    Coord result;
    result.x = refPoint.x - d * std::sin(theta);
    result.y = refPoint.y + d * std::cos(theta);
    return result;
}

FrenetCoord getFrenetCoordinates(const Coord &pos) {
    std::vector<Coord> refLine = buildReferenceLine1();
    double minDist = std::numeric_limits<double>::max();
    double sAtMin = 0.0;
    double dAtMin = 0.0;
    double sAccum = 0.0;

    for (size_t i = 0; i < refLine.size() - 1; i++) {
        Coord A = refLine[i];
        Coord B = refLine[i+1];
        double dx = B.x - A.x;
        double dy = B.y - A.y;
        double segLen = std::sqrt(dx * dx + dy * dy);

        double t = ((pos.x - A.x) * dx + (pos.y - A.y) * dy) / (segLen * segLen);
        if (t < 0) t = 0;
        if (t > 1) t = 1;

        double projX = A.x + t * dx;
        double projY = A.y + t * dy;
        double dist = std::hypot(pos.x - projX, pos.y - projY);

        if (dist < minDist) {
            minDist = dist;
            sAtMin = sAccum + t * segLen;
            double cross = dx * (pos.y - A.y) - dy * (pos.x - A.x);
            dAtMin = (cross >= 0 ? dist : -dist);
        }

        sAccum += segLen;
    }
    return { sAtMin, dAtMin };
}

} // namespace veins
